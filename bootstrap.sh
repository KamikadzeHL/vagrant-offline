#!/usr/bin/env bash

set -e
echo "*****************************************************************************************"
echo "******************************* Install Java version 8 *************************************"
echo "*****************************************************************************************"
set -e
apt-get update
apt-get install openjdk-8-jre -y
echo "*****************************************************************************************"
echo "******************************* Add Jenkins to soure list *******************************"
echo "*****************************************************************************************"

wget -q -O - https://pkg.jenkins.io/debian-stable/jenkins.io.key | sudo apt-key add -
sh -c 'echo deb https://pkg.jenkins.io/debian-stable binary/ > /etc/apt/sources.list.d/jenkins.list'

echo "*****************************************************************************************"
echo "******************************* Install Update and Jenkins ******************************"
echo "*****************************************************************************************"
apt-get update
apt-get install jenkins -y

echo "*****************************************************************************************"
echo "********************************** Make Jenkins local  **********************************"
echo "*****************************************************************************************"

if ! [ -L /var/lib/jenkins ]; then
  sudo rm -rf /var/lib/jenkins
  sudo ln -fs /vagrant/jenkins /var/lib/jenkins
fi 

echo "*****************************************************************************************"
echo "********************************* Restart Jenkins local  ********************************"
echo "*****************************************************************************************"
service jenkins restart


